@inherits Mainlayoutbase

@using Mihcelle.Hwavmvid.Fileupload
@using Mihcelle.Hwavmvid.Shared.Models

@inject NavigationManager navigationmanager

<AuthorizeView>
    <Authorized>

        <div class="container">
            <div class="row align-items-center my-2">

                <div class="col-md-4">
                    <div class="text-center">

                        <strong>Brandmark</strong>

                    </div>
                </div>

                <div class="col-md-4">
                    <div class="p-1 bg-light">

                        <Fileuploadcomponent ApiUrl="api/site/brandmark" InputFileId="@this.Brandmarkinputfieldid" DropzoneElementId="@this.Brandmarkdropzoneelementid"></Fileuploadcomponent>

                    </div>
                </div>

                <div class="col-md-4">

                    <img src="@string.Concat(this.navigationmanager.BaseUri, "images/", site?.Brandmark)" class="img-fluid" />

                </div>

                <div class="col-md-4">
                    <div class="text-center">
                        <strong>Favicon</strong>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="p-1 bg-light">

                        <Fileuploadcomponent ApiUrl="api/site/favicon" InputFileId="@this.Faviconinputfieldid" DropzoneElementId="@this.Favicondropzoneelementid"></Fileuploadcomponent>

                    </div>
                </div>

                <div class="col-md-4">

                    <img src="@string.Concat(this.navigationmanager.BaseUri, "images/", site?.Favicon)" class="img-fluid" />

                </div>

            </div>
        </div>

    </Authorized>
    <NotAuthorized>

    </NotAuthorized>
</AuthorizeView>


@code {


    // Site model
    public Applicationsite? site { get; set; }

    // Brandmark
    public string Brandmarkdropzoneelementid { get; set; } = "brandmark_dropzone_element_id";
    public string Brandmarkinputfieldid { get; set; } = "brandmark_input_field_id";

    // Favicon
    public string Favicondropzoneelementid { get; set; } = "favicon_dropzone_element_id";
    public string Faviconinputfieldid { get; set; } = "favicon_input_field_id";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {

        var client = this.ihttpclientfactory.CreateClient("Mihcelle.Hwavmvid.ServerApi.Unauthenticated");
        this.site = await client.GetFromJsonAsync<Applicationsite>("api/site");

        await base.OnAfterRenderAsync(firstRender);
    }

}
